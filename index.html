<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN">
<head>
    <meta name="generator" content="jemdoc, see http://jemdoc.jaboc.net/" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <link rel="stylesheet" href="styles.css" type="text/css" />
    <link rel="shortcut icon" href="/image/neu.png" type="image/x-icon" />
    <title>刘骐瑞 - 个人主页</title>
</head>
<body>

<div id="page-header">
    <div class="header-content-wrapper">
        <div class="profile-image-container">
            <img src="/image/photo.jpg" alt="刘骐瑞" id="profile-picture-header">
        </div>
        <div class="header-info">
            <h1 id="user-name-header">刘骐瑞</h1>
            <p class="affiliation">东北大学 · 计算机科学与技术专业</p>
            <div class="contact-header" id="contact-header-block">
                <div class="contact-item">
                    <span class="contact-icon">📧</span>
                    <a href="mailto:202212056@stu.neuq.edu.cn">202212056@stu.neuq.edu.cn</a>
                </div>
                <div class="contact-item">
                    <span class="contact-icon">📞</span>
                    <span>15204369625</span>
                </div>
                <div class="contact-item">
                    <span class="contact-icon">💬</span> <span>微信 (WeChat): neuq67r</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="top-navigation-container">
    <div id="progress-bar-container"><div id="progress-bar"></div></div>
    <div id="top-navbar">
        <div class="nav-logo"><a href="#page-header">刘骐瑞 | 个人主页</a></div>
        <nav class="nav-links">
            <a href="#about-me-section">About Me</a>
            <a href="#education-section">Education</a>
            <a href="#publications-section">Research Experience</a>
            <a href="#awards-section">Awards</a>
            <a href="#contact-me-card-section">Contact</a>
        </nav>
    </div>
</div>

<table summary="Table for page layout." id="tlayout">
<tr valign="top">
<td id="layout-menu">
    <h4>快速导航</h4>
    <div class="menu-item">
        <a href="index.html" class="current">
            <span class="menu-icon">🏠</span> Menu
        </a>
    </div>
    <div class="menu-item">
        <a href="https://github.com/neuqrui" target="_blank" rel="noopener noreferrer">
            <span class="menu-icon">💻</span> GitHub
        </a>
    </div>
    <div class="menu-item">
        <a href="https://www.luogu.com.cn/article/0ityj0pu7" target="_blank" rel="noopener noreferrer">
            <span class="menu-icon">🔗</span> LuoGu
        </a>
    </div>
    <div class="menu-item">
        <a href="https://scholar.google.com.hk/citations?user=phiH1v0AAAAJ&hl=zh-CN" target="_blank" rel="noopener noreferrer">
            <span class="menu-icon">🎓</span> Google Scholar
        </a>
    </div>
</td>
<td id="layout-content">

    <section id="about-me-section">
    <h2>About me</h2>
    <div class="about-me-cards-container">
        <div class="about-me-card self-introduction-card">
            <h4><span class="card-icon">🌟</span> 自我介绍</h4>
            <p>我来自<strong>东北大学</strong>计算机科学与技术专业，是一名2022级的本科生，目前正值大三学年。我怀揣着对知识的渴望与学术的热忱，正积极寻求攻读<strong>研究生</strong>或<strong>博士学位</strong>的机会，期待在更高层次的学术殿堂中继续深造与探索。</p>
        </div>
        <div class="about-me-card">
            <h4><span class="card-icon">💡</span> 科研基础</h4>
            <p>在科研实践中，我已熟练掌握并能够灵活运用以下核心技术与工具：</p>
            <ul>
                <li><strong>框架与平台：</strong> MindSpeed-RL（华为大模型训练框架）、PyTorch、OpenCompass（大模型评测平台）、熟练运用华为昇腾服务器。</li>
                <li><strong>核心算法：</strong> 对DAPO、GRPO、PPO以及经典的AlphaZero等强化学习算法有深入的理解与实践经验。</li>
            </ul>
        </div>
        <div class="about-me-card">
            <h4><span class="card-icon">🔬</span> 科研之旅</h4>
            <ul>
                <li><strong>2022.07 – 2023.10：</strong> 作为东北大学<strong>ACM集训队队员</strong>，系统性地磨练了算法设计思维与程序实现能力。</li>
                <li><strong>2023.12 – 2025.02：</strong> 参与东北大学<strong>悟空机器博弈实验室</strong>的研究项目，专注于<strong>深度强化学习(DRL)</strong>及其在复杂棋类博弈场景中的应用与优化。</li>
                <li><strong>2025.03 – 至今：</strong> 在<strong>浙江大学TruthLab实验室</strong>进行科研实习，当前主攻方向为<strong>推理模型安全对齐</strong>技术，探索前沿理论与实践方法。</li>
            </ul>
        </div>
        <div class="about-me-card">
            <h4><span class="card-icon">🏀</span> 兴趣爱好</h4>
            <p>学习之余，我注重劳逸结合与身心健康。周末时光，我常与朋友们驰骋<strong>篮球</strong>场，享受团队合作与竞技运动带来的乐趣。在周一至周五的日常中，我会坚持健身房<strong>力量训练</strong>（通常每两天一次），以此锤炼意志，释放压力。</p>
        </div>
        <div class="about-me-card full-width-card">
            <h4><span class="card-icon">🚀</span> 未来展望</h4>
            <p>我对<strong>大模型（LLM）、强化学习（Reinforcement Learning）</strong>以及<strong>具身智能（Embodied Intelligence）</strong>等人工智能前沿领域抱有浓厚的学术兴趣与探索热情。我乐于追踪并学习领域内的最新动态与技术热点，并坚信以<strong>AlphaZero</strong>为代表的<strong>“从零开始学习”</strong>的强化学习范式，将是未来人工智能发展的核心驱动力与重要突破方向之一。</p>
        </div>
    </div>
</section>

<section id="education-section">
    <h2>教育背景</h2>
    <ul>
        <li><p><strong>2003.12.20:</strong> 出生于吉林省白城市</p></li>
        <li><p><strong>2007.09 – 2010.09:</strong> 成才幼儿园</p></li> <li><p><strong>2010.09 – 2016.09:</strong> 明仁小学</p></li> <li><p><strong>2016.09 – 2019.09:</strong> 白城市第三中学</p></li> <li><p><strong>2019.09 – 2022.09:</strong> 白城市第一中学</p></li> <li>
            <p><strong>2022.09 – 2026.09 (预计):</strong> 东北大学 - 计算机科学与技术 本科</p> <ul class="education-details">
                <li><strong>专业排名:</strong> 15 / 191 (专业前 7.9%)</li>
                <li><strong>英语水平:</strong> CET-6: 449</li>
                <li><strong>核心课程:</strong>
                    <ul class="course-list"> <li>高等数学 (99)</li>
                        <li>人工智能导论 (98)</li>
                        <li>C++程序设计 (97)</li>
                        <li>算法设计与分析 (97)</li>
                        <li>数据结构 (96)</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
</section>

<section id="publications-section">
    <h2>科研经历</h2>
    <div class="tabs-container research-tabs-container">
        <div class="tab-buttons">
            <button class="tab-button active" data-tab="boxeszero-paper" type="button"><strong>NEU:</strong> BoxesZero 点格棋智能体</button>
            <button class="tab-button" data-tab="deepseek-rl-exp" type="button"><strong>ZJU:</strong> Deepseek-safe</button>
        </div>

        <div class="tab-content active" id="tab-boxeszero-paper">
            <h3><strong>BoxesZero: An Efficient and Computationally Frugal Dots-and-Boxes Agent</strong> <br>(JCR 2 区期刊，共同一作)</h3>
            <div class="paper-detail-layout">
                <aside class="paper-mini-nav">
                    <h4>本篇内容</h4>
                    <ul>
                        <li><a href="#boxeszero-overview" class="mini-nav-link">论文概述</a></li>
                        <li><a href="#boxeszero-methods" class="mini-nav-link">核心方法</a></li>
                        <li><a href="#boxeszero-experiment" class="mini-nav-link">实验结果</a></li>
                    </ul>
                </aside>
                <div class="paper-main-content">
                    <div class="paper-subsection-card" id="boxeszero-overview">
                        <h4>论文概述与负责内容</h4>
                        <p><strong>论文概述：</strong>针对Alphazero架构回报信号稀疏，对计算资源需求高，资源利用率低等问题，本文提出了BoxesZero一种dots and boxes智能体，融合多种创新技术：
                            1.预训练两阶段的self-play方法，第一阶段采用大量数据利用回报Q进行预训练，第二阶段引入全局奖励信号z进行微调，使得策略网络收敛。
                            2.data augmentation的方法：在MCTS中筛选出高质量的节点增加数据量，并采用分布式的架构使得数据生成和训练可以同时进行。
                            3.残局定理的证明。
                            4.引入领域知识。实验结果表明：相同模型参数下预测准确率达到alphazero的两倍，仅训练40h elo分数快速达到1600，仅用了alphazero 1/4的时间。并且模型在训练280h时涌现出了一种尚未发现的策略；最终结果打败了Dots and boxes网上开源的所有模型取得了SOTA水平，
                            并且获得中国大学生计算机博弈大赛全国一等奖<strong>(冠军)</strong>, 北京大学Botzone平台第一名。代码公开在 <a href="https://github.com/neuqrui/-Distributed-Computer-Games-Framework" target="_blank" rel="noopener noreferrer">GitHub Link</a>。</p>
                        <p><strong>负责内容：</strong>提出并实现整个BoxesZero框架；复现AAAI论文 Solving Dots and Boxes ；残局定理的数学推导；整体实验的设计，在机房大规模部署模型约30台机器； 构造了1万条数据集用于测试; 参与整个论文的撰写包括摘要，引言，方法，实验和结论等章节；论文所有图片的绘制。</p>
                    </div>
                    <div class="paper-subsection-card" id="boxeszero-methods">
                        <h4>核心方法</h4>
                        <h5>Two-stage self-play：</h5>
                        <p>在模型初期我们只采集残局的数据(这样的数据具有真实的回报信号，进行预训练(这个过程相当于价值网络在学习对丰富的局面的价值评估),
                模型逐步前进，通过观察可以看到局的状态价值从0逐渐接近1，表明价值网络在提升，可以辨别出局面的输赢。在self-play第一阶段收集的数据为不同局面经过MCTS
                搜索后根节点的状态价值Q(S)训练价值网络以及MCTS返回的策略pi。此阶段由于价值信号较为丰富，价值网络收敛较快，因此称为Strengthen value network。
                在self-play的第二阶段采用0.25Q+0.75z的混合价值信号方法。第二阶段相当于对策略网络进行微调，预训练阶段的学习任务相当于对局面进行认知判断，但是最终的目
                的只要能赢就可以，因此采用输赢z进行微调，在此过程中可以观察到策略网络的收敛。因此为Strengthen policy network。</p>
                        <p><img src="/image/two_stage_play.jpg" alt="Two stage self-play" class="clickable-img full-width-img"></p>
                        <h5>Data augmentation:</h5>
                        <p>针对预训练阶段的数据量少的问题提出了一种Data augmentation的方法，在alphazero的做法中mcts搜索结束后，就将整个树都丢弃了，我
                们考虑在树中抽取一些高质量的节点，进行训练。具体方案可以根据节点搜索次数N，选择Top k个节点(K取3~5)，或者根据固定的N和Q的约束条件，因为N，Q绝对值越大，可以在一定程度上说明这个节点质量高。最终经过旋转对称再一次数据增强。</p>
                        <p><img src="/image/dataaug.jpg" alt="Data augmentation" class="clickable-img full-width-img"></p>
                        <h5>Extended endgame theorem:</h5>
                        <p>针对点格棋本身的局面特性可以找出一些必走策略，在MCTS中遇到这种必走节点可以只纵向展开，不横向展开。经过剪枝的MCTS的树形更加的身，也就意味着奖励信号更加充足。 在已有的残局定理基础上证明了存在含有1-chain和2-chain的局面。</p>
                        <p><img src="/image/endgame.jpg" alt="Extended endgame theorem" class="clickable-img full-width-img"></p>
                        <h5>Network Structure:</h5>
                        <p>我们的网络结构主要分为三个部分：</p> <ol class="network-steps">
                        <li>Input层：对棋盘进行初步手工特征提取，将一个H*W的棋盘变为（3，H，W）3个channel。第一个channel是分数差，第二个channel表示边的位置（有边为1，无边为0），第三个channel表示格子的状态（有格子为1，无为0）。这种提取方式不会损失棋盘原始的任何信息。</li>
                        <li>特征提取层：主要采用N块类似残差块（Residual Block）的网络结构，负责对局面进行更深层次的特征提取。</li>
                        <li>输出层：分为Value head和Policy head。分别输出当前棋盘的状态价值（state value）和在该局面下的策略（policy π）。</li>
                    </ol>
                        <p><img src="/image/net.jpg" alt="Network Structure Diagram" class="clickable-img" style="width:100%;max-width:1000px;"></p>
                    </div>
                    <div class="paper-subsection-card" id="boxeszero-experiment">
                        <h4>实验 (Experiment)</h4>
                        <p>通过实验，我们证明了BoxesZero在多个指标上都优于现有的方法。例如，在与基线模型的对比中，BoxesZero在胜率和收敛速度方面均表现出色。消融实验进一步验证了我们提出的各个创新点（如两阶段自博弈、数据增强）的有效性。下图展示了部分关键实验结果和对比数据。</p>
                        <div class="image-gallery">
                            <div class="image-row">
                                <img src="image/消融.jpg" alt="消融实验图示" class="clickable-img gallery-img">
                                <img src="image/back.jpg" alt="实验背景或另一角度图示" class="clickable-img gallery-img">
                            </div>
                            <img src="image/xiaorongtable.jpg" alt="消融实验表格" class="clickable-img full-width-img content-img">
                            <img src="image/finaltable.jpg" alt="最终结果表格" class="clickable-img full-width-img content-img">
                            <div class="image-row">
                                <img src="image/dataa.jpg" alt="数据增强A效果" class="clickable-img gallery-img">
                                <img src="image/datab.jpg" alt="数据增强B效果" class="clickable-img gallery-img">
                            </div>
                            <div class="image-row">
                                <img src="image/finala.jpg" alt="最终结果图A" class="clickable-img gallery-img">
                                <img src="image/finalb.jpg" alt="最终结果图B" class="clickable-img gallery-img">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="tab-deepseek-rl-exp">
    <h3>利用 Deepseek-R1-Distill-7B 进行分布式强化学习训练</h3>
    <p><strong>核心背景：</strong> 本项研究在两台<strong>昇腾(Ascend) 910B</strong>服务器组成的集群上，针对 <strong>Deepseek-R1-Distill-7B</strong> 模型，成功实施并优化了分布式 <strong>GRPO</strong> 与 <strong>DAPO</strong> 强化学习训练流程。</p>

    <div class="paper-subsection-card">
        <h4>奖励函数 (Reward Function) 设计</h4>
        <p>为确保模型生成内容的高质量与安全性，我们构建了一个多维度、精细化的奖励函数，其核心组成部分包括：</p>
        <ol class="custom-reward-list">
            <li><strong>"Think"过程安全性：</strong> 评估模型在内部思考、推理链生成阶段的安全合规性，确保其思维路径不偏离安全基准。</li>
            <li><strong>"Answer"安全性：</strong> 严格评估模型最终输出答案的安全性，旨在消除任何潜在的有害、不当或有偏见的内容。</li>
            <li><strong>"Think"与"Answer"一致性：</strong> 考量模型的思考过程（中间步骤或解释）与其最终答案之间的逻辑连贯性与因果自洽性。</li>
            <li><strong>"Answer"有用性：</strong> 从用户角度出发，评估模型答案对于具体请求的实际帮助程度、信息量、准确性及相关性。</li>
        </ol>
    </div>

    <div class="paper-subsection-card">
        <h4>主要实验结果</h4>
        <p>通过在general和safety评测集上的实验，我们验证了GRPO/DAPO训练方案及精细化奖励函数设计的有效性。以下图表展示了部分关键的性能指标、收敛曲线或具体案例分析：</p>
        <div class="image-gallery">
            <div class="image-row">
                <img src="image/safe-reward.png" alt="Deepseek 实验结果 - 图1" class="clickable-img gallery-img">
                <img src="image/response_length.png" alt="Deepseek 实验结果 - 图2" class="clickable-img gallery-img">
            </div>
            <img src="image/exp_table.png" alt="Deepseek 实验结果 - 图3" class="clickable-img full-width-img content-img">
            </div>
            </div>
            <img src="image/chat.png" alt="Deepseek 实验结果 - 图4" class="clickable-img full-width-img content-img">
            </div>
    </div>
    </div>
    </div>
</section>

<section id="awards-section">
    <h2>获奖总览</h2>
    <div class="tabs-container">
        <div class="tab-buttons">
            <button class="tab-button active" data-tab="competitions" type="button">竞赛获奖</button>
            <button class="tab-button" data-tab="honors" type="button">荣誉称号</button>
            <button class="tab-button" data-tab="scholarships" type="button">奖学金</button>
        </div>
        <div class="tab-content active" id="tab-competitions">
            <h3>竞赛获奖</h3>
            <ul class="awards-list">
                <li><span class="award-level-icon national-icon" title="国家级">🏆</span> 中国大学生计算机博弈大赛点格棋赛道 (队长)&nbsp;&nbsp;北京大学 Botzone 平台第一名，国家级一等奖(冠军)</li>
                <li><span class="award-level-icon national-icon" title="国家级">🏆</span> 中国大学生计算机博弈大赛五子棋赛道 (队长)&nbsp;&nbsp;国家级一等奖</li>
                <li><span class="award-level-icon national-icon" title="国家级">🏅</span> 机器人开发者大赛 (RAICOM) 全国总决赛"编程技能赛"&nbsp;&nbsp;国家级三等奖</li>
                <li><span class="award-level-icon national-icon" title="国家级">🥉</span> 中国大学生程序设计竞赛国赛（CCPC）秦皇岛站&nbsp;&nbsp;（铜牌打星）国家级三等奖</li>
                <li><span class="award-level-icon other-icon" title="其他">🎗️</span> 中国大学生程序设计竞赛国赛（CCPC）桂林站&nbsp;&nbsp;优胜奖</li>
                <li><span class="award-level-icon provincial-icon" title="省级">🏅</span> 全国大学生数学竞赛（河北赛区）&nbsp;&nbsp;省级二等奖</li>
                <li><span class="award-level-icon provincial-icon" title="省级">🏅</span> 蓝桥杯大赛 C++ A 组编程赛（河北赛区）&nbsp;&nbsp;省级二等奖</li>
            </ul>
            <div class="certificate-section awards-certificates">
                <h4>相关证书/照片</h4>
                <div class="certificate-grid">
                    <div class="certificate-item"><img src="image/competition2.jpg" alt="计算机博弈大赛冠军"><div class="certificate-caption">计算机博弈大赛 冠军</div></div>
                    <div class="certificate-item"><img src="image/competition1.jpg" alt="点格棋赛道一等奖"><div class="certificate-caption">点格棋赛道 国家级一等奖</div></div>
                    <div class="certificate-item"><img src="image/competition3.jpg" alt="五子棋赛道一等奖"><div class="certificate-caption">五子棋赛道 国家级一等奖</div></div>
                    <div class="certificate-item"><img src="image/competition6.jpg" alt="睿抗机器人开发者大赛"><div class="certificate-caption">睿抗机器人开发者大赛 国家级一等奖</div></div>
                    <div class="certificate-item"><img src="image/competition5.jpg" alt="CCPC桂林站"><div class="certificate-caption">CCPC桂林站 优胜奖</div></div>
                    <div class="certificate-item"><img src="image/competition4.jpg" alt="数学竞赛"><div class="certificate-caption">数学竞赛 省级二等奖</div></div>
                    <div class="certificate-item"><img src="image/competition7.jpg" alt="图灵杯"><div class="certificate-caption">图灵杯 二等奖</div></div>
                    <div class="certificate-item"><img src="image/competition8.jpg" alt="CCPC秦皇岛站"><div class="certificate-caption">CCPC秦皇岛站 铜牌</div></div>
                    <div class="certificate-item"><img src="image/competition9.jpg" alt="CCPC秦皇岛站铜牌"><div class="certificate-caption">CCPC秦皇岛站 铜牌</div></div>
                </div>
            </div>
        </div>
        <div class="tab-content" id="tab-honors">
            <h3>荣誉称号</h3>
            <div class="certificate-section awards-certificates">
                <h4>相关证书/照片</h4>
                <div class="certificate-grid">
                    <div class="certificate-item"><img src="image/honor1.jpg" alt="三好学生标兵"><div class="certificate-caption">三好学生标兵</div></div>
                    <div class="certificate-item"><img src="image/honor2.jpg" alt="三好学生"><div class="certificate-caption">三好学生</div></div>
                    <div class="certificate-item"><img src="image/honor3.jpg" alt="优秀团员标兵"><div class="certificate-caption">优秀团员标兵</div></div>
                    <div class="certificate-item"><img src="image/honor4.jpg" alt="学习标兵"><div class="certificate-caption">学习标兵</div></div>
                </div>
            </div>
        </div>
        <div class="tab-content" id="tab-scholarships">
            <h3>奖学金</h3>
            <div class="certificate-section awards-certificates">
                <h4>相关证书/照片</h4>
                <div class="certificate-grid">
                    <div class="certificate-item"><img src="image/scholarship1.jpg" alt="国家励志奖学金"><div class="certificate-caption">国家励志奖学金</div></div>
                    <div class="certificate-item"><img src="image/scholarship2.jpg" alt="校综合一等奖学金"><div class="certificate-caption">校综合一等奖学金</div></div>
                    <div class="certificate-item"><img src="image/scholarship3.jpg" alt="校综合一等奖学金"><div class="certificate-caption">校综合一等奖学金</div></div>
                    <div class="certificate-item"><img src="image/scholarship4.jpg" alt="创新创业奖学金"><div class="certificate-caption">创新创业奖学金</div></div>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="contact-me-card-section">
    <h2>联系我</h2>
    <p>目前正在申请研究生/博士生学位。</p>
    <p>我感兴趣的研究方向为：<strong>大模型 (Large Models)</strong>、<strong>强化学习 (Reinforcement Learning)</strong>、<strong>具身智能 (Embodied Intelligence)</strong>。</p>
    <p>如果您在相关领域有合作机会，或者是有招生名额的老师希望进一步交流，欢迎随时通过以下方式联系我：</p>
    <div class="contact-details-in-card">
        <div class="contact-item-in-card">
            <span class="contact-icon">💬</span> <span>微信 (WeChat)： neuq67r</span>
        </div>
        <div class="contact-item-in-card">
            <span class="contact-icon">📞</span> <span>电话 (Phone)： 15204369625</span>
        </div>
        <div class="contact-item-in-card">
            <span class="contact-icon">📧</span> <span>邮箱 (Email)： <a href="mailto:202212056@stu.neuq.edu.cn">202212056@stu.neuq.edu.cn</a></span>
        </div>
    </div>
</section>

<div id="footer">
<div id="footer-text">
&copy; 2025 刘骐瑞. 保留所有权利.
</div>
</div>
</td>
</tr>
</table>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const progressBar = document.getElementById('progress-bar');
    const topNavigationContainer = document.getElementById('top-navigation-container');
    const navLinks = document.querySelectorAll('#top-navbar .nav-links a');
    const sections = [];

    navLinks.forEach(link => {
        const sectionId = link.getAttribute('href').substring(1);
        const sectionElement = document.getElementById(sectionId);
        if (sectionElement) {
            sections.push(sectionElement);
        }
    });

    function updateProgressBar() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        if (scrollHeight > 0) {
            const scrolled = (scrollTop / scrollHeight) * 100;
            progressBar.style.width = scrolled + '%';
        } else {
            progressBar.style.width = '0%';
        }
    }

    function initializePaperMiniNav() {
        const paperDetailLayout = document.querySelector('#tab-boxeszero-paper .paper-detail-layout');
        if (!paperDetailLayout) {
            // console.warn("Mini-nav: 'BoxesZero' paper detail layout not found.");
            return;
        }

        const miniNavLinks = paperDetailLayout.querySelectorAll('.paper-mini-nav a.mini-nav-link');
        const paperSubsectionsForHighlighting = [];
        const mainNavbar = document.getElementById('top-navigation-container');

        if (!mainNavbar) {
            console.error("Mini-nav: Main navigation '#top-navigation-container' not found! Scroll offsets will be inaccurate.");
        }

        miniNavLinks.forEach(link => {
            const href = link.getAttribute('href');
            if (!href || href.charAt(0) !== '#') {
                // console.warn(`Mini-nav: Link has invalid href: ${href}`);
                return;
            }

            const targetId = href.substring(1);
            const targetElement = document.getElementById(targetId);

            if (targetElement) {
                paperSubsectionsForHighlighting.push(targetElement);

                link.addEventListener('click', function(e) {
                    e.preventDefault();

                    const parentTabContent = targetElement.closest('.tab-content');
                    if (!parentTabContent || !parentTabContent.classList.contains('active') || getComputedStyle(parentTabContent).display === 'none') {
                        return;
                    }

                    const mainNavbarHeight = mainNavbar ? mainNavbar.offsetHeight : 0;
                    const elementRect = targetElement.getBoundingClientRect();
                    const absoluteElementTop = elementRect.top + window.pageYOffset;

                    const scrollTargetY = absoluteElementTop - mainNavbarHeight - 15;

                    window.scrollTo({
                        top: scrollTargetY,
                        behavior: 'smooth'
                    });
                });
            } else {
                // console.warn(`Mini-nav: Target element for link '${href}' not found.`);
            }
        });

        function highlightMiniNavLink() {
            if (paperSubsectionsForHighlighting.length === 0) return;

            const boxesZeroTab = document.getElementById('tab-boxeszero-paper');
            if (!boxesZeroTab || !boxesZeroTab.classList.contains('active') || getComputedStyle(boxesZeroTab).display === 'none') {
                miniNavLinks.forEach(navLink => navLink.classList.remove('active'));
                return;
            }

            const scrollPosition = window.pageYOffset;
            const mainNavbarHeight = mainNavbar ? mainNavbar.offsetHeight : 0;
            let currentSubSectionId = '';

            for (let i = paperSubsectionsForHighlighting.length - 1; i >= 0; i--) {
                const subsection = paperSubsectionsForHighlighting[i];
                const subsectionRect = subsection.getBoundingClientRect();
                const absoluteSubsectionTop = subsectionRect.top + window.pageYOffset;

                const effectiveActivationPoint = absoluteSubsectionTop - mainNavbarHeight - 25;

                if (scrollPosition >= effectiveActivationPoint) {
                    currentSubSectionId = subsection.getAttribute('id');
                    break;
                }
            }

            if (!currentSubSectionId && paperSubsectionsForHighlighting.length > 0) {
                const firstSubsection = paperSubsectionsForHighlighting[0];
                const firstSubsectionRect = firstSubsection.getBoundingClientRect();
                const absoluteFirstSubsectionTop = firstSubsectionRect.top + window.pageYOffset;
                const effectiveFirstSubsectionTop = absoluteFirstSubsectionTop - mainNavbarHeight - 25;

                if (scrollPosition < effectiveFirstSubsectionTop) {
                    currentSubSectionId = firstSubsection.getAttribute('id');
                }
            }

            miniNavLinks.forEach(navLink => {
                navLink.classList.remove('active');
                const linkHref = navLink.getAttribute('href');
                if (linkHref && linkHref.substring(1) === currentSubSectionId) {
                    navLink.classList.add('active');
                }
            });
        }

        if (miniNavLinks.length > 0) {
            window.addEventListener('scroll', highlightMiniNavLink);

            const boxesZeroTabElement = document.getElementById('tab-boxeszero-paper');
            if (boxesZeroTabElement) {
                const observer = new MutationObserver((mutationsList) => {
                    for(let mutation of mutationsList) {
                        if (mutation.type === 'attributes' && (mutation.attributeName === 'class' || mutation.attributeName === 'style')) {
                            highlightMiniNavLink();
                            break;
                        }
                    }
                });
                observer.observe(boxesZeroTabElement, { attributes: true, attributeFilter: ['class', 'style'] });

                if (boxesZeroTabElement.classList.contains('active') && getComputedStyle(boxesZeroTabElement).display !== 'none') {
                    highlightMiniNavLink();
                }
            } else {
                highlightMiniNavLink();
            }
        }
    }

    function initializeTabs(tabContainerSelector) {
        const tabContainer = document.querySelector(tabContainerSelector);
        if (!tabContainer) {
            return;
        }

        const tabButtons = tabContainer.querySelectorAll('.tab-button');
        const tabContents = Array.from(tabContainer.children).filter(child => child.classList.contains('tab-content'));

        if (tabButtons.length > 0 && tabContents.length > 0) {
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    const contentsInThisContainer = tabContainer.querySelectorAll('.tab-content');
                    contentsInThisContainer.forEach(content => content.classList.remove('active'));

                    button.classList.add('active');
                    const targetTabId = button.getAttribute('data-tab');
                    const targetContent = tabContainer.querySelector('#tab-' + targetTabId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                });
            });

            const isActiveTabPresent = tabContainer.querySelector('.tab-button.active');
            if (!isActiveTabPresent && tabButtons.length > 0) {
                tabButtons[0].classList.add('active');
                const firstTabContentId = tabButtons[0].getAttribute('data-tab');
                const firstTabContent = tabContainer.querySelector('#tab-' + firstTabContentId);
                if (firstTabContent) {
                    firstTabContent.classList.add('active');
                }
            }
        }
    }

    if (topNavigationContainer) {
        const topNavObserver = new IntersectionObserver(
            ([e]) => e.target.classList.toggle('is-pinned', e.intersectionRatio < 1),
            { threshold: [1] }
        );
        topNavObserver.observe(topNavigationContainer);
    }

    navLinks.forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);

            if (targetElement) {
                let scrollTargetY;
                const navbarHeight = topNavigationContainer ? topNavigationContainer.offsetHeight : 0; // Add check for topNavigationContainer

                if (targetElement.id === 'page-header' || targetElement.closest('#page-header')) {
                     scrollTargetY = targetElement.offsetTop; // For elements at the top, offsetTop is usually fine
                } else {
                    // For elements below navbar, use getBoundingClientRect for accuracy
                    const elementRect = targetElement.getBoundingClientRect();
                    const absoluteElementTop = elementRect.top + window.pageYOffset;
                    scrollTargetY = absoluteElementTop - navbarHeight - 15; // 15px buffer
                }

                window.scrollTo({
                    top: scrollTargetY,
                    behavior: 'smooth'
                });
            }
        });
    });

    function highlightActiveLink() {
        let currentSectionId = '';
        const stickyNavbarHeight = (topNavigationContainer && (topNavigationContainer.classList.contains('is-pinned') || getComputedStyle(topNavigationContainer).position === 'sticky')) ? topNavigationContainer.offsetHeight : 0;
        const scrollPosition = window.pageYOffset;

        for (let i = sections.length - 1; i >= 0; i--) {
            const section = sections[i];
            const sectionRect = section.getBoundingClientRect();
            const absoluteSectionTop = sectionRect.top + window.pageYOffset;

            let effectiveSectionTop = absoluteSectionTop - stickyNavbarHeight;

            // No offset for #page-header if it's considered the very top "section"
            if (section.id === 'page-header') {
                 effectiveSectionTop = absoluteSectionTop;
            }

            effectiveSectionTop -= 20; // Buffer

            if (scrollPosition >= effectiveSectionTop) {
                currentSectionId = section.getAttribute('id');
                break;
            }
        }

        if (!currentSectionId && sections.length > 0 ) {
            const firstSection = sections[0];
            const firstSectionRect = firstSection.getBoundingClientRect();
            const absoluteFirstSectionTop = firstSectionRect.top + window.pageYOffset;
            let effectiveFirstSectionTop = absoluteFirstSectionTop - stickyNavbarHeight;
            if (firstSection.id === 'page-header') {
                effectiveFirstSectionTop = absoluteFirstSectionTop;
            }
            effectiveFirstSectionTop -=20;

            if(scrollPosition < effectiveFirstSectionTop) {
                currentSectionId = sections[0].getAttribute('id');
            }
        }

        navLinks.forEach(link => {
            link.classList.remove('active');
            const linkHref = link.getAttribute('href');
            if (linkHref && linkHref.substring(1) === currentSectionId) {
                link.classList.add('active');
            }
        });
    }

    window.addEventListener('scroll', () => {
        updateProgressBar();
        highlightActiveLink(); // Main nav highlighting
    });

    updateProgressBar();
    initializeTabs('#awards-section .tabs-container');
    initializeTabs('#publications-section .tabs-container');
    initializePaperMiniNav(); // Initialize mini-nav for BoxesZero paper
    highlightActiveLink();
});
</script>

</body>
</html>